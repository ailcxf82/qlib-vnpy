# å¿«é€Ÿå¼€å§‹æŒ‡å—

## ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡

### 1.1 å®‰è£…Python

ç¡®ä¿å®‰è£…äº†Python 3.8æˆ–æ›´é«˜ç‰ˆæœ¬ï¼š

```bash
python --version
```

### 1.2 å®‰è£…ä¾èµ–åŒ…

```bash
pip install -r requirements.txt
```

æˆ–ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿï¼š

```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 1.3 åˆå§‹åŒ–Qlibæ•°æ®

#### é€‰é¡¹Aï¼šä½¿ç”¨å®˜æ–¹æ•°æ®ï¼ˆæ¨èï¼‰

```bash
# ä¸‹è½½Aè‚¡æ•°æ®åˆ°é»˜è®¤è·¯å¾„
python -m qlib.run.get_data qlib_data --target_dir ~/.qlib/qlib_data/cn_data --region cn
```

#### é€‰é¡¹Bï¼šä½¿ç”¨è‡ªå®šä¹‰æ•°æ®

å¦‚æœä½ æœ‰è‡ªå·±çš„æ•°æ®ï¼Œä¿®æ”¹ `config/data.yaml`ï¼š

```yaml
qlib:
  provider_uri: "ä½ çš„æ•°æ®è·¯å¾„"  # ä¾‹å¦‚: "D:/qlib_data/cn_data"
  region: "cn"
```

## ç¬¬äºŒæ­¥ï¼šé…ç½®å‚æ•°

### 2.1 æ•°æ®é…ç½® (`config/data.yaml`)

```yaml
market:
  universe: "csi300"  # è‚¡ç¥¨æ± ï¼šcsi300, csi500, all
  start_time: "2017-01-01"  # å¼€å§‹æ—¶é—´
  end_time: "2024-12-31"  # ç»“æŸæ—¶é—´
```

### 2.2 æ¨¡å‹é…ç½® (`config/model.yaml`)

```yaml
model_type: "lightgbm"  # æ¨¡å‹ç±»å‹

lightgbm:
  learning_rate: 0.05  # å­¦ä¹ ç‡
  n_estimators: 200  # æ ‘çš„æ•°é‡
  device: "cpu"  # ä½¿ç”¨CPUæˆ–GPU
```

### 2.3 è®­ç»ƒé…ç½® (`config/pipeline.yaml`)

```yaml
rolling:
  train_window: 156  # è®­ç»ƒçª—å£ï¼ˆå‘¨ï¼‰ï¼š3å¹´ = 156å‘¨
  step: 1  # æ»šåŠ¨æ­¥é•¿ï¼ˆå‘¨ï¼‰

label:
  name: "next_week_return"  # æ ‡ç­¾åç§°
```

### 2.4 å›æµ‹é…ç½® (`config/backtest.yaml`)

```yaml
backtest:
  start_date: "2020-01-01"  # å›æµ‹å¼€å§‹æ—¥æœŸ
  end_date: "2024-12-31"  # å›æµ‹ç»“æŸæ—¥æœŸ
  capital: 10000000  # åˆå§‹èµ„é‡‘

strategy:
  top_n: 20  # é€‰è‚¡æ•°é‡
```

## ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œç³»ç»Ÿ

### 3.1 æ£€æŸ¥ç¯å¢ƒ

```bash
python example_usage.py
```

è¿™ä¼šæ£€æŸ¥ï¼š
- é…ç½®æ–‡ä»¶æ˜¯å¦å®Œæ•´
- ç›®å½•ç»“æ„æ˜¯å¦æ­£ç¡®
- PythonåŒ…æ˜¯å¦å·²å®‰è£…

### 3.2 è¿è¡Œå®Œæ•´æµç¨‹ï¼ˆæ¨èï¼‰

```bash
python pipeline/run_all.py
```

è¿™ä¼šè‡ªåŠ¨æ‰§è¡Œï¼š
1. å› å­è®¡ç®—
2. ç‰¹å¾å·¥ç¨‹
3. æ¨¡å‹è®­ç»ƒ
4. ç”Ÿæˆé¢„æµ‹

### 3.3 åˆ†æ­¥è¿è¡Œ

å¦‚æœä½ æƒ³åˆ†æ­¥æ‰§è¡Œï¼š

#### æ­¥éª¤1ï¼šè®­ç»ƒæ¨¡å‹

```bash
python pipeline/run_train.py
```

è¾“å‡ºï¼š`data/models/model_YYYYMMDD.txt`

#### æ­¥éª¤2ï¼šç”Ÿæˆé¢„æµ‹

```bash
python pipeline/run_predict.py
```

è¾“å‡ºï¼š`data/predictions/pred_YYYY-MM-DD.csv`

#### æ­¥éª¤3ï¼šè¿è¡Œå›æµ‹

```bash
python backtest/run_vnpy_backtest.py
```

è¾“å‡ºï¼š
- `data/backtest_results/equity_curve.csv`
- `data/backtest_results/trades.csv`
- `data/backtest_results/positions.csv`

## ç¬¬å››æ­¥ï¼šæŸ¥çœ‹ç»“æœ

### 4.1 æŸ¥çœ‹æ—¥å¿—

æ‰€æœ‰æ—¥å¿—ä¿å­˜åœ¨ `logs/` ç›®å½•ï¼š

```bash
# Windows
type logs\run_all_*.log

# Linux/Mac
cat logs/run_all_*.log
```

### 4.2 æŸ¥çœ‹é¢„æµ‹ç»“æœ

é¢„æµ‹æ–‡ä»¶æ ¼å¼ï¼ˆCSVï¼‰ï¼š

```csv
instrument,score
000001.SZ,0.0523
000002.SZ,0.0312
000063.SZ,0.0298
...
```

### 4.3 æŸ¥çœ‹å›æµ‹æŠ¥å‘Š

æ—¥å¿—ä¸­ä¼šè¾“å‡ºå›æµ‹ç»“æœï¼š

```
å›æµ‹ç»“æœ:
  åˆå§‹èµ„é‡‘: 10,000,000
  æœ€ç»ˆèµ„é‡‘: 12,500,000
  æ€»æ”¶ç›Šç‡: 25.00%
  å¹´åŒ–æ”¶ç›Š: 18.50%
  æœ€å¤§å›æ’¤: -12.30%
  å¤æ™®æ¯”ç‡: 1.85
  æ€»äº¤æ˜“æ¬¡æ•°: 520
```

## å¸¸è§é—®é¢˜

### Q1: Qlibåˆå§‹åŒ–å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š`ValueError: Cannot find provider uri`

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥æ•°æ®æ˜¯å¦å·²ä¸‹è½½
2. æ£€æŸ¥ `config/data.yaml` ä¸­çš„è·¯å¾„æ˜¯å¦æ­£ç¡®
3. å°è¯•ä½¿ç”¨ç»å¯¹è·¯å¾„

### Q2: å†…å­˜ä¸è¶³

**é”™è¯¯ä¿¡æ¯**ï¼š`MemoryError`

**è§£å†³æ–¹æ³•**ï¼š
1. å‡å°‘è‚¡ç¥¨æ± èŒƒå›´ï¼ˆæ”¹ç”¨csi300è€Œä¸æ˜¯allï¼‰
2. å‡å°‘è®­ç»ƒçª—å£
3. å‡å°‘å› å­æ•°é‡

### Q3: è®­ç»ƒå¾ˆæ…¢

**è§£å†³æ–¹æ³•**ï¼š
1. ä½¿ç”¨GPUåŠ é€Ÿ
2. å‡å°‘ç‰¹å¾æ•°é‡
3. è°ƒæ•´æ¨¡å‹å‚æ•°ï¼ˆå‡å°‘n_estimatorsï¼‰
4. ä½¿ç”¨æ›´å°çš„è‚¡ç¥¨æ± 

### Q4: é¢„æµ‹æ–‡ä»¶ä¸ºç©º

**åŸå› **ï¼šå¯èƒ½æ˜¯å› å­è®¡ç®—å¤±è´¥æˆ–æ•°æ®ä¸è¶³

**è§£å†³æ–¹æ³•**ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
2. æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
3. è°ƒæ•´æ—¶é—´èŒƒå›´

## GPUåŠ é€Ÿï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ æœ‰NVIDIA GPUï¼Œå¯ä»¥å¯ç”¨GPUåŠ é€Ÿï¼š

### 1. å®‰è£…CUDA

ä» [NVIDIAå®˜ç½‘](https://developer.nvidia.com/cuda-downloads) ä¸‹è½½å®‰è£…CUDAã€‚

### 2. å®‰è£…GPUç‰ˆæœ¬çš„LightGBM

```bash
pip uninstall lightgbm
pip install lightgbm --install-option=--gpu
```

### 3. ä¿®æ”¹é…ç½®

ç¼–è¾‘ `config/model.yaml`ï¼š

```yaml
lightgbm:
  device: "gpu"
  gpu_platform_id: 0
  gpu_device_id: 0
```

## ä¸‹ä¸€æ­¥

- ğŸ“– é˜…è¯» [README.md](README.md) äº†è§£è¯¦ç»†åŠŸèƒ½
- ğŸ”§ ä¿®æ”¹é…ç½®æ–‡ä»¶ä¼˜åŒ–å‚æ•°
- ğŸ“Š åˆ†æå›æµ‹ç»“æœ
- ğŸš€ å°è¯•æ·»åŠ è‡ªå®šä¹‰å› å­
- ğŸ’¡ æ¢ç´¢ä¸åŒçš„æ¨¡å‹å’Œç­–ç•¥

## è·å–å¸®åŠ©

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
2. é˜…è¯» README.md
3. æ£€æŸ¥é…ç½®æ–‡ä»¶
4. æäº¤Issue

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰

